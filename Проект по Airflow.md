---
tags:
  - Apache
  - Big_data
  - Book
  - Airflow
---
## –ü—Ä–µ–¥—ã—Å—Ç–æ—Ä–∏—è üöÄ

>[!tip] –ó–∞–ø—É—Å–∫–∏ —Ä–∞–∫–µ—Ç
>**–†–∞–∫–µ—Ç—ã** - –Ω–∞—Å—Ç–æ—è—â–µ–µ —Ç–≤–æ—Ä–µ–Ω–∏–µ –∏–Ω–∂–µ–Ω–µ—Ä–Ω–æ–π –º—ã—Å–ª–∏ —á–µ–ª–æ–≤–µ—á–µ—Å—Ç–≤–∞. –ö–∞–∂–¥—ã–π —Ä–∞–∑ —Å–º–æ—Ç—Ä—è –≤ –Ω–µ–±–æ, —è –ø–æ–Ω–∏–º–∞—é, —á—Ç–æ —Å–µ–π—á–∞—Å –≥–¥–µ-—Ç–æ —Ç–∞–º, –≤ –º–∏–ª–ª–∏–∞—Ä–¥–∞—Ö –∫–∏–ª–æ–º–µ—Ç—Ä–∞—Ö –æ—Ç –Ω–∞—Å –ª–µ—Ç—è—Ç **–í–æ—è–¥–∂–µ—Ä—ã**, –≥–¥–µ-—Ç–æ —Ç–∞–º –Ω–∞ **–ú–ö–°** –ª—é–¥–∏ –≤—ã—Ö–æ–¥—è—Ç –Ω–∞ –æ—Ä–±–∏—Ç—É. –ê –≥–¥–µ-—Ç–æ –Ω–æ–≤–µ–π—à–∏–π —Ç–µ–ª–µ—Å–∫–æ–ø **–î–∂–µ–π–º—Å –£—ç–±–±** –¥–µ–ª–∞–µ—Ç —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏. –ù–æ –Ω–∏—á–µ–≥–æ –∏–∑ —ç—Ç–æ–≥–æ –Ω–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–æ –±—ã –±–µ–∑ —Ä–∞–∫–µ—Ç.
>
>![[telescope.jpg]]

## –ó–∞–¥–∞—á–∞ üíª

- –ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ –≤—ã –∑–∞—Ö–æ—Ç–µ–ª–∏ —Å–æ–∑–¥–∞—Ç—å –Ω–µ–±–æ–ª—å—à–æ–π –ø—Ä–æ–µ–∫—Ç –ø–æ **–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏** –≤—ã–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –æ–±–æ –≤—Å–µ—Ö **–∑–∞–ø—É—Å–∫–∞—Ö —Ä–∞–∫–µ—Ç**, —á—Ç–æ–±—ã –∏–º–µ—Ç—å —Å–≤–æ–µ–≥–æ —Ä–æ–¥–∞ –ª–∏—á–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–±—ã—Ç–∏—è—Ö, –∫–∞—Å–∞—é—â–∏—Ö—Å—è —ç—Ç–∏—Ö –∑–∞–ø—É—Å–∫–æ–≤. –î–æ–ø—É—Å—Ç–∏–º, —Å–Ω–∞—á–∞–ª–∞ –º—ã —Ö–æ—Ç–∏–º –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–±–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —ç—Ç–∏—Ö —Ä–∞–∫–µ—Ç.

## –ò–∑—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö üîç

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã–π **API** –¥–ª—è –≤—Å–µ—Ö –Ω–∞ –ø–ª–∞–Ω–µ—Ç–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∏ –±—É–¥—É—â–∏—Ö –∑–∞–ø—É—Å–∫–∞—Ö —Ä–∞–∫–µ—Ç –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, —Å–æ–±—Ä–∞–Ω–Ω–æ–µ –≤–æ–µ–¥–∏–Ω–æ –æ—Ç [Launch Library 2](https://thespacedevs.com/llapi). –û–≥—Ä–∞–Ω–∏—á–∏–º—Å—è —Ç–æ–ª—å–∫–æ [–ø—Ä–µ–¥—Å—Ç–æ—è—â–∏–º–∏](https://ll.thespacedevs.com/2.0.0/launch/upcoming/)  –∑–∞–ø—É—Å–∫–∞–º–∏ —Ä–∞–∫–µ—Ç. –°—Å—ã–ª–∫–∞ –¥–ª—è **API**:
```python
curl -L "https://ll.thespacedevs.com/2.0.0/launch/upcoming"
```

–ò–ª–∏ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–µ–±–æ–ª—å—à–æ–π –∫–æ–¥ –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å, –∫–∞–∫–æ–π –∂–µ —Å–∞–º—ã–π –±–ª–∏–∂–∞–π—à–∏–π –∑–∞–ø—É—Å–∫ —Ä–∞–∫–µ—Ç—ã –≤ –º–∏—Ä–µ —Å–æ—Å—Ç–æ–∏—Ç—Å—è:

```python
import os
import json

info=os.popen('curl -L "https://ll.thespacedevs.com/2.0.0/launch/upcoming"').read()
info=json.loads(info)
launch_list=info['results']
print(len(launch_list)) #10 –∑–∞–ø—É—Å–∫–æ–≤ –∑–∞–µ—Ç—Å—è –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –≤ –∑–∞–ø—Ä–æ—Å–µ
print(json.dumps(launch_list[0], indent=4))
```

–ù–∞ —á—Ç–æ –º—ã –ø–æ–ª—É—á–∞–µ–º –≤–æ—Ç —Ç–∞–∫–æ–π json —Ñ–∞–π–ª —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ **–±–ª–∏–∂–∞–π—à–µ–º** –ø—Ä–µ–¥—Å—Ç–æ—è—â–µ–º –∑–∞–ø—É—Å–∫–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–∞–µ—Ç—Å—è 10 –±–ª–∏–∂–∞–π—à–∏—Ö –∑–∞–ø—É—Å–∫–æ–≤, –Ω–æ –º–æ–∂–Ω–æ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –∏ –≤—Å–µ):

```
{
    "id": "1c099ba2-9b8f-4364-8ba0-0c26f7993dd5",
    "url": "https://ll.thespacedevs.com/2.0.0/launch/1c099ba2-9b8f-4364-8ba0-0c26f7993dd5/",
    "launch_library_id": null,
    "slug": "falcon-9-block-5-starlink-group-6-18",
    "name": "Falcon 9 Block 5 | Starlink Group 6-18",
    "status": {
        "id": 2,
        "name": "TBD"
    },
    "net": "2023-09-24T00:06:00Z",
    "window_end": "2023-09-24T04:37:00Z",
    "window_start": "2023-09-24T00:06:00Z",
    "inhold": false,
    "tbdtime": false,
    "tbddate": false,
    "probability": null,
    "holdreason": "",
    "failreason": "",
    "hashtag": null,
    "launch_service_provider": {
        "id": 121,
        "url": "https://ll.thespacedevs.com/2.0.0/agencies/121/",
        "name": "SpaceX",
        "type": "Commercial"
    },
    "rocket": {
        "id": 7870,
        "configuration": {
            "id": 164,
            "launch_library_id": 188,
            "url": "https://ll.thespacedevs.com/2.0.0/config/launcher/164/",
            "name": "Falcon 9",
            "family": "Falcon",
            "full_name": "Falcon 9 Block 5",
            "variant": "Block 5"
        }
    },
    "mission": {
        "id": 6378,
        "launch_library_id": null,
        "name": "Starlink Group 6-18",
        "description": "A batch of satellites for the Starlink mega-constellation - SpaceX's project for space-based Internet communication system.",
        "launch_designator": null,
        "type": "Communications",
        "orbit": {
            "id": 8,
            "name": "Low Earth Orbit",
            "abbrev": "LEO"
        }
    },
    "pad": {
        "id": 80,
        "url": "https://ll.thespacedevs.com/2.0.0/pad/80/",
        "agency_id": 121,
        "name": "Space Launch Complex 40",
        "info_url": null,
        "wiki_url": "https://en.wikipedia.org/wiki/Cape_Canaveral_Air_Force_Station_Space_Launch_Complex_40",
        "map_url": "https://www.google.com/maps?q=28.56194122,-80.57735736",
        "latitude": "28.56194122",
        "longitude": "-80.57735736",
        "location": {
            "id": 12,
            "url": "https://ll.thespacedevs.com/2.0.0/location/12/",
            "name": "Cape Canaveral, FL, USA",
            "country_code": "USA",
            "map_image": "https://spacelaunchnow-prod-east.nyc3.digitaloceanspaces.com/media/launch_images/location_12_20200803142519.jpg",
            "total_launch_count": 908,
            "total_landing_count": 37
        },
        "map_image": "https://spacelaunchnow-prod-east.nyc3.digitaloceanspaces.com/media/launch_images/pad_80_20200803143323.jpg",
        "total_launch_count": 200
    },
    "webcast_live": false,
    "image": "https://spacelaunchnow-prod-east.nyc3.digitaloceanspaces.com/media/launch_images/falcon2520925_image_20230522091403.png",
    "infographic": null,
    "program": []
}

```

>[!warning] –í–Ω–∏–º–∞–Ω–∏–µ!
>- –î–∞–Ω–Ω—ã—Ö API –æ—á–µ–Ω—å –∏ –æ—á–µ–Ω—å —Å–µ—Ä—å–µ–∑–µ–Ω. –≠—Ç–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–∫–ª–∞—Ä–∏—Ä—É—é—Ç—Å—è –≤ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ. 
>- –í—ã –º–æ–∂–µ—Ç–µ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –æ–± –æ–¥–Ω–æ–º –∑–∞–ø—É—Å–∫–µ —É–∂–µ –∏–∑–≤–µ—Å—Ç–Ω–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–Ω–æ–≥–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –æ–¥–Ω–∞–∫–æ –±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –∫ –ø—Ä–∏–º–µ—Ä—É, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ —Å–≤–æ–¥–∫–∞ –æ —Ä–∞–∫–µ—Ç–µ, –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–µ –∑–∞–ø—É—Å–∫–∞, –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ, –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –¢–∞–∫, –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ —Ä–∞–∫–µ—Ç–µ, –µ—Å–ª–∏ —Å–¥–µ–ª–∞—Ç—å –µ—â–µ –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å.

–ú–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –µ—â–µ –æ–¥–Ω—É —Å—Å—ã–ª–∫—É —Å –¥–∞–Ω–Ω—ã–º–∏ –æ —Ä–∞–∫–µ—Ç–µ, –µ—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É:
`rocket_info=launch_list[0]["rocket"]["configuration"]["url"]`

>[!fail] –ó–∞—â–∏—Ç–∞ –æ—Ç DDOS
>–û–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –Ω–µ —Å—Ç–æ–∏—Ç —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ —ç—Ç–æ–º—É API, –ø–æ—Ç–æ–º—É —á—Ç–æ —Ç—É—Ç, **–û–ö–ê–ó–´–í–ê–ï–¢–°–Ø**, —Å—Ç–æ–∏—Ç –∑–∞—â–∏—Ç–∞ –æ—Ç ddos –∞—Ç–∞–∫ (—á—Ç–æ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –Ω–µ—á–∞—Å—Ç–æ). –ú–Ω–µ –∑–∞–±–ª–æ—á–∏–ª–∏ –¥–æ—Å—Ç—É–ø –Ω–∞ 30 –º–∏–Ω—É—Ç –∏–∑-–∑–∞ —á–∞—Å—Ç—ã—Ö –æ—Ç–ø—Ä–∞–≤–æ–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (—Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –ø–æ ip, –ø–æ—ç—Ç–æ–º—É —Å–ª–∏—à–∫–æ–º —É–ø–æ—Ä–Ω—ã–º —Å–∫–∞–∂—É - **–û–±–æ–π—Ç–∏ –≤–æ–∑–º–æ–∂–Ω–æ üòÜ**). –£–∑–Ω–∞–ª —Ç–∞–∫–∂–µ –æ–±—ã—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è - **15 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —á–∞—Å**.

–ö—Ä—á –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é —Å–≤–æ–¥–∫—É –æ —Ä–∞–∫–µ—Ç–µ, –∫ –ø—Ä–∏–º–µ—Ä—É –≤–æ—Ç —á—Ç–æ —è —É—Å–ø–µ–ª –ø–æ–π–º–∞—Ç—å –ø–æ–∫–∞ –Ω–µ –∑–∞–±–ª–æ—á–∏–ª–∏:

```python
"variant": "Block 5",
            "alias": "",
            "min_stage": 1,
            "max_stage": 2,
            "length": 70.0,
            "diameter": 3.65,
            "maiden_flight": "2018-05-11",
            "launch_mass": 549,
            "leo_capacity": 22800,
            "gto_capacity": 8300,
            "to_thrust": 7607,
            "apogee": 200,
            "vehicle_range": null,
            "image_url": "[https://spacelaunchnow-prod-east.nyc3.digitaloceanspaces.com/media/launcher_images/falcon_9_image_20230807133459.jpeg](https://spacelaunchnow-prod-east.nyc3.digitaloceanspaces.com/media/launcher_images/falcon_9_image_20230807133459.jpeg)",
            "info_url": "[https://www.spacex.com/vehicles/falcon-9/](https://www.spacex.com/vehicles/falcon-9/)",
            "wiki_url": "[https://en.wikipedia.org/wiki/Falcon_9](https://en.wikipedia.org/wiki/Falcon_9)",
            "total_launch_count": 201,
            "consecutive_successful_launches": 201,
            "successful_launches": 201,
            "failed_launches": 0,
            "pending_launches": 123
```

### –ò—Ç–æ–≥
–ö–∞–∫ –≤–∏–¥–∏—Ç–µ, –¥–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ **JSON** –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–ø—É—Å–∫–µ —Ä–∞–∫–µ—Ç—ã, –∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –µ—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ä–∞–∫–µ—Ç–µ, —Ç–∞–∫–∞—è –∫–∞–∫ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä, –∏–º—è –∏ URL-–∞–¥—Ä–µ—Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –≠—Ç–æ –∏–º–µ–Ω–Ω–æ —Ç–æ, —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ. –î–∞–≤–∞–π—Ç–µ **–Ω–∞—Ä–∏—Å—É–µ–º –∫–∞—Ä—Ç—É**, –∏ —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º –∏—Ö —Å –∑–∞–¥–∞—á–∞–º–∏ –¥–ª—è Airflow

![[Pasted image 20230922232032.png]]

## –ü–∏—à–µ–º –ø–µ—Ä–≤—ã–π **–û–ê–ì** üßê

–ù–∞—á–Ω–µ–º –ø–∏—Å–∞—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É, –∑–∞–æ–¥–Ω–æ —Ä–∞–∑–±–µ—Ä–µ–º –∫–∞–∂–¥—É—é —Å—Ç—Ä–æ–∫—É.

- –ü–µ—Ä–≤—ã–º –¥–µ–ª–æ–º –¥–æ–±–∞–≤–∏–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å **json** —Ñ–∞–π–ª–∞–º–∏ (—Å–ª–æ–≤–∞—Ä—è–º–∏)
```python
import json
```

- –î–∞–ª—å—à–µ –¥–∞–≤–∞–π—Ç–µ –≤—Å–ø–æ–º–Ω–∏–º, —á—Ç–æ –≤ —Ä–∞–∑–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö —Å—É—â–µ—Å—Ç–≤—É—é—Ç —Å–≤–æ–∏ –ø—Ä–∞–≤–∏–ª–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø—É—Ç–µ–π –∫ —Ñ–∞–π–ª–∞–º. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ Linux –¥–ª—è –ø—É—Ç–µ–π –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä—è–º—ã–µ —Å–ª—ç—à–∏ (`/`), –∞ –≤ Windows ‚Äî –æ–±—Ä–∞—Ç–Ω—ã–µ —Å–ª—ç—à–∏ (`\`). –î–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –≤ –ª—é–±–æ–π **–û–°**, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å Pathlib, –∫–æ—Ç–æ—Ä—ã–π –æ–±–µ—Å–ø–µ—á–∏—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é —Ä–∞–±–æ—Ç—É –Ω–∞ –≤—Å–µ—Ö **–û–°**
```python
import pathlib
```

–û—Å—Ç–∞–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏ —Ä–∞–∑–±–µ—Ä–µ–º –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ.

–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ç–µ–ø–µ—Ä—å –Ω–∞ –∫–æ–¥ —Ü–µ–ª–∏–∫–æ–º, –∏ –ø–æ—Å–ª–µ –º—ã –æ–±—Å—É–¥–∏–º –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–æ–º–µ–Ω—Ç—ã.

```python
import json
import pathlib
import airflow 
import requests 
import requests.exceptions as requests_exceptions 
from airflow import DAG 
from airflow.operators.bash_operator import BashOperator #–í –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏—è—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–µ—Ç–æ–¥ .bash
from airflow.operators.python_operator import PythonOperator #–í –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏—è—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–µ—Ç–æ–¥ .python

dag = DAG( 
    dag_id="download_rocket_launches", 
    start_date=airflow.utils.dates.days_ago(14), 
    schedule_interval=None,)

download_launches = BashOperator( 
    task_id="download_launches", 
    # bash_command='(if not exist tmp (mkdir tmp)) & curl -o tmp/launches.json -L "https://ll.thespacedevs.com/2.0.0/launch/upcoming"', #–î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –Ω–∞ Windows
    bash_command="curl -o tmp/launches.json -L 'https://ll.thespacedevs.com/2.0.0/launch/upcoming'", # –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ –Ω–∞ Linux
    dag=dag, )

def _get_pictures(): # –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –∫–∞—Ç–∞–ª–æ–≥ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç 
    pathlib.Path("tmp/images").mkdir(parents=True, exist_ok=True) 
    
    # –°–∫–∞—á–∏–≤–∞–µ–º –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ launches.json 
    with open("tmp/launches.json") as f: 
        launches = json.load(f) 
        image_urls = [launch["image"] for launch in launches["results"]] 
        for image_url in image_urls: 
            try: 
                response = requests.get(image_url) 
                image_filename = image_url.split("/")[-1] 
                target_file = f"tmp/images/{image_filename}"
                with open(target_file, "wb") as f: 
                    f.write(response.content) 
                print(f"Downloaded {image_url} to {target_file}") 
            except requests_exceptions.MissingSchema: 
                print(f"{image_url} appears to be an invalid URL.") 
            
            except requests_exceptions.ConnectionError: 
                print(f"Could not connect to {image_url}.")

get_pictures = PythonOperator( 
    task_id="get_pictures", 
    python_callable=_get_pictures, 
    dag=dag, )

notify = BashOperator( 
    task_id="notify", 
    bash_command='echo "There are now $(ls tmp/images/ | wc -l) images."', 
    dag=dag, )

download_launches >> get_pictures >> notify
```

## –†–∞–∑–±–æ—Ä –∫–æ–¥–∞ üêî

–†–∞–∑–±–µ—Ä–µ–º —ç—Ç–æ—Ç —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å. **–û–ê–ì** ‚Äì —ç—Ç–æ –æ—Ç–ø—Ä–∞–≤–Ω–∞—è —Ç–æ—á–∫–∞ –ª—é–±–æ–≥–æ —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞. –í—Å–µ –∑–∞–¥–∞—á–∏ –≤ —Ä–∞–º–∫–∞—Ö —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å—Å—ã–ª–∞—é—Ç—Å—è –Ω–∞ —ç—Ç–æ—Ç –æ–±—ä–µ–∫—Ç **–û–ê–ì**, —á—Ç–æ–±—ã Airflow –∑–Ω–∞–ª, –∫–∞–∫–∏–µ –∑–∞–¥–∞—á–∏ –∫–∞–∫–æ–º—É **–û–ê–ì** –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç.
```python
dag = DAG( dag_id="download_rocket_launches", start_date=airflow.utils.dates.days_ago(14), schedule_interval=None,)
```

>[!info] –ß—Ç–æ –µ—Å—Ç—å —á—Ç–æ
>- –ö–ª–∞—Å—Å DAG –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–≤–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–∞: **dag_id, start_date**.
>- **dag_id** - —ç—Ç–æ –∏–º—è –û–ê–ì, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ Airflow.
>- **start_date** - –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è, –∫–æ–≥–¥–∞ —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –≤ –ø–µ—Ä–≤—ã–π —Ä–∞–∑
>- **schedule_interval**=None - –û–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –û–ê–ì –Ω–µ –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –ü–æ–∑–∂–µ –º—ã –∑–∞–π–º–µ–º—Å—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º, –ø–æ–∫–∞ –æ—Å—Ç–∞–≤–∏–º –∑–∞–ø—É—Å–∫ –Ω–∞ —Ä—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ.

–ó–∞—Ç–µ–º —Å—Ü–µ–Ω–∞—Ä–∏–π —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ Airflow —Å–æ—Å—Ç–æ–∏—Ç –æ–±—ã—á–Ω–æ –∏–∑ –æ–¥–Ω–æ–≥–æ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç —Ä–∞–∑–ª–∏—á–Ω—É—é —Ä–∞–±–æ—Ç—É. –¢–∞–∫, –≤ –∫–æ–¥–µ —Å–ª–µ–¥—É—é—â–∏–º –º—ã –∑–∞–ø—É—Å–∫–∞–µ–º **BashOperator** –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–æ–º–∞–Ω–¥—ã **Bash**.
```python
download_launches = BashOperator( 
    task_id="download_launches", 
    # bash_command='(if not exist tmp (mkdir tmp)) & curl -o tmp/launches.json -L "https://ll.thespacedevs.com/2.0.0/launch/upcoming"', #–î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –Ω–∞ Windows
    bash_command="curl -o tmp/launches.json -L 'https://ll.thespacedevs.com/2.0.0/launch/upcoming'", # –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ –Ω–∞ Linux
    dag=dag, )
```

>[!info] –ê –∑–¥–µ—Å—å —á—Ç–æ –Ω–∞–ø–∏—Å–∞–Ω–æ?
>**task_id** - –ò–º—è –∑–∞–¥–∞—á–∏
>**bash_command** - –ö–æ–º–∞–Ω–¥–∞ Bash –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
>**dag**=dag - –°—Å—ã–ª–∫–∞ –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é DAG
>`curl -o /tmp/launches.json -L 'https://ll.thespacedevs.com/2.0.0/launch/upcoming'`:
>**curl -o** - –≠—Ç–æ –æ–ø—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≥–æ–≤–æ—Ä–∏—Ç curl —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–ª–æ –æ—Ç–≤–µ—Ç–∞ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ. –û–ø—Ü–∏—è -L –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –ø–æ –ª—é–±–æ–º—É –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é, –ø–æ–∫–∞ –Ω–µ –¥–æ—Å—Ç–∏–≥–Ω–µ—Ç –∫–æ–Ω–µ—á–Ω–æ–≥–æ –ø—É–Ω–∫—Ç–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –Ω–µ –∏–≥—Ä–∞–µ—Ç –Ω–∏–∫–∞–∫–æ–π —Ä–æ–ª–∏, –Ω–æ –æ—Å—Ç–∞–≤–∏–º.
>**if not exist** –¥–æ–±–∞–≤–∏–ª –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–∞–ø–∫–∏ tmp –µ—Å–ª–∏ –µ–µ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –Ω–µ –±—ã–ª–æ

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏
`download_launches >> get_pictures >> notify`
–í Airflow –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å *–±–∏–Ω–∞—Ä–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä —Å–¥–≤–∏–≥–∞ –≤–ø—Ä–∞–≤–æ* –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –º–µ–∂–¥—É –∑–∞–¥–∞—á–∞–º–∏. –¢–∞–∫ –º–æ–∂–Ω–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞ –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è, –ø–æ–∫–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è –µ–π –ø—Ä–µ–¥—ã–¥—É—â–∞—è.
> –í Python –¥–ª—è —Å–¥–≤–∏–≥–æ–≤ –±–∏—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä `>>`

### –ó–∞–¥–∞—á–∏ –∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã
–í—ã –º–æ–∂–µ—Ç–µ –º–µ–Ω—è —Å–ø—Ä–æ—Å–∏—Ç—å: –≤ —á–µ–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É **–∑–∞–¥–∞—á–∞–º–∏** –∏ **–æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏**?
- [!] –í Airflow **–æ–ø–µ—Ä–∞—Ç–æ—Ä—ã** —Å—É—â–µ—Å—Ç–≤—É—é—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–¥–Ω–æ–π –µ–¥–∏–Ω–∏—Ü—ã —Ä–∞–±–æ—Ç—ã. –ö –ø—Ä–∏–º–µ—Ä—É, —Å—É—â–µ—Å—Ç–≤—É—é—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä:
- **BashOperator** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è Bash
- **EmailOperator** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É—é –ø–æ—á—Ç—É
- **PythonOperator** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏ Python
–†–æ–ª—å **–û–ê–ì** —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ–±—ã –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞–±–æ—Ä–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤. –ó–∞–¥–∞—á–∏ –∂–µ - –∫–∞–∫ –æ–±–æ–ª–æ—á–∫–∞ –¥–ª—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤. –° —ç—Ç–∏–º–∏ –∑–∞–¥–∞—á–∞–º–∏ –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –≤ –±—É–¥—É—â–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ, –∏ –ø–æ—Ç–æ–º —É–∂–µ –¥–µ–ª–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –∑–∞–¥–∞—á–∞–º–∏ –¥–ª—è **–û–ê–ì**

### –ó–∞–ø—É—Å–∫ —Ñ—É–Ω–∫—Ü–∏–∏ Python —Å –ø–æ–º–æ—â—å—é **PythonOperator**

```python
def _get_pictures(): # –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –∫–∞—Ç–∞–ª–æ–≥ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç 
    pathlib.Path("tmp/images").mkdir(parents=True, exist_ok=True) 
    
    # –°–∫–∞—á–∏–≤–∞–µ–º –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ launches.json 
    with open("tmp/launches.json") as f: 
        launches = json.load(f) 
        image_urls = [launch["image"] for launch in launches["results"]] 
        for image_url in image_urls: 
            try: 
                response = requests.get(image_url) 
                image_filename = image_url.split("/")[-1] 
                target_file = f"tmp/images/{image_filename}"
                with open(target_file, "wb") as f: 
                    f.write(response.content) 
                print(f"Downloaded {image_url} to {target_file}") 
            except requests_exceptions.MissingSchema: 
                print(f"{image_url} appears to be an invalid URL.") 
            
            except requests_exceptions.ConnectionError: 
                print(f"Could not connect to {image_url}.")

```

>[!note] - –†–∞–∑–±–æ—Ä —Ñ—É–Ω–∫—Ü–∏–∏
>1. **pathlib.Path("/tmp/images").mkdir(parents=True, exist_ok=True)** - –°–æ–∑–¥–∞–µ—Ç –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –ø—É—Ç–∏ –ø–∞–ø–∫–∏. `parents=True` –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ –º–µ—Ç–æ–¥ —Å–æ–∑–¥–∞—Å—Ç –≤—Å–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –∫–∞—Ç–∞–ª–æ–≥–∏ –ø—Ä–∏ –∏—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏. –ø—Ä–∏ `False` –∂–µ, –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç, –≤—ã–¥–∞—Å—Ç –æ—à–∏–±–∫—É. `exist_ok=True` —É–±–∏—Ä–∞–µ—Ç –æ—à–∏–±–∫—É, –µ—Å–ª–∏ –ø–∞–ø–∫–∏ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç.
>2. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç json —Ñ–∞–π–ª, –æ—Ç—Ç—É–¥–∞ —á–∏—Ç–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –ø–µ—Ä–µ–≤–æ–¥–∏–º –µ–µ –≤ **python —Å–ª–æ–≤–∞—Ä—å**. –ü–æ—Å–ª–µ –º—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ **results** –Ω–∞—Ö–æ–¥–∏–º –∫–ª—é—á **image** - —ç—Ç–æ –∏ –±—É–¥–µ—Ç —Å—Å—ã–ª–∫–∞ –Ω–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏.
>3. –°–æ–∑–¥–∞–µ–º –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏, —Ä–∞–∑–¥–µ–ª—è—è –ø—É—Ç—å –∑–∞–ø—Ä–æ—Å–∞ —Å–∏–º–≤–æ–ª–æ–º `/` –∏ –æ—Å—Ç–∞–≤–ª—è—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞ - —ç—Ç–æ –∏ –±—É–¥–µ—Ç **–Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞**
>4. –°–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π —Ñ–∞–π–ª —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏, –∏ –≤ –Ω–µ–≥–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∫–æ–Ω—Ç–µ–Ω—Ç —Å —Å—Å—ã–ª–∫–∏ –Ω–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é
>5. –ï—Å–ª–∏ –æ—à–∏–±–∫–∏ —Å URL –∏–ª–∏ —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º, —Ç–æ –ø–∏—à–µ–º –æ—à–∏–±–∫–∏, –Ω–æ –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞.

–î–∞–ª—å—à–µ —É–∂–µ –≤—Å—ë –ø—Ä–µ–¥–µ–ª—å–Ω–æ –ø–æ–Ω—è—Ç–Ω–æ, —Ç—Ä–µ—Ç–∏–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –ø—Ä–æ—Å—Ç–æ –ø–∏—à–µ—Ç –∫–æ–ª-–≤–æ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –≤ –ø–∞–ø–∫–µ.

## –ó–∞–ø—É—Å–∫ –û–ê–ì –≤ Airflow üò±

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ —É –Ω–∞—Å –µ—Å—Ç—å **–û–ê–ì**, –∏–ª–∏ –∂–µ DAG —Ñ–∞–π–ª, –¥–∞–≤–∞–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏–º –µ–≥–æ –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ **Airflow**.

–ó–∞–ø—É—Å—Ç–∏–º Docker –∏ –Ω–∞—à –≥–æ—Ç–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–ü—Ä–æ—á–∏—Ç–∞—Ç—å –æ–± —ç—Ç–æ–º –º–æ–∂–Ω–æ –≤ [[proj1_theory]]). –¢–µ–ø–µ—Ä—å –Ω–∞–ø–∏—à–µ–º –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∫–æ–º–∞–Ω–¥—É, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç –Ω–∞—à DAG —Ñ–∞–π–ª –≤ –Ω—É–∂–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:

1. –¢–∞–∫ –∫–∞–∫ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –ø–∞–ø–∫–∏ **dags** —É –Ω–∞—Å –Ω–µ—Ç, —Ç–æ –µ–µ –º—ã –¥–æ–ª–∂–Ω—ã —Å–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞—Ç—å, –∞ –ø–æ—Ç–æ–º —É–∂–µ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å —Ç—É–¥–∞ —Ñ–∞–π–ª. –°–¥–µ–ª–∞—Ç—å —ç—Ç–æ –º–æ–∂–Ω–æ –∫–æ–º–∞–Ω–¥–æ–π `mkdir dags` –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Å–æ–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

![[Pasted image 20230924120250.png]]

2. –ü–µ—Ä–µ–¥–∞—Ç—å —Ñ–∞–π–ª –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–æ–º–∞–Ω–¥–æ–π:
```cmd
docker cp D:\Mindspace\Apache\proj1_practice\etl_try_1.py 0baa77bd960ddf01fd094d1e4de0dea52b76ab96e57a6cebb82a0e7180191581:/usr/local/airflow/dags/etl_try_1.py
```
---
–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –º–æ–∂–Ω–æ –∑–∞–Ω–æ–≤–æ –ø–æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∞ —Ç–æ—Ç —É–¥–∞–ª–∏—Ç—å.
```cmd
docker pull puckel/docker-airflow
docker run -d -p 8080:8080 puckel/docker-airflow webserver
```

–¢–µ–ø–µ—Ä—å –∑–∞–π–¥–µ–º –Ω–∞ Airflow, –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º, –ø–æ—è–≤–∏–ª—Å—è –ª–∏ –Ω–∞—à –û–ê–ì –≤ —Å–ø–∏—Å–∫–µ.

![[Pasted image 20230924120535.png]]

### –ü–æ–∑–¥—Ä–∞–≤–ª—è—é, –≤—ã —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–∏–ª–∏ —Å–≤–æ–π –ø–µ—Ä–≤—ã–π DAG —Ñ–∞–π–ª!

## –†–∞–∑–±–æ—Ä –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ Airflow/DAGs üìá

–û—Ç–∫—Ä–æ–µ–º –Ω–∞—à DAG —Ñ–∞–π–ª, –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫–∏–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –∑–∞ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º —É –Ω–∞—Å –∏–º–µ—é—Ç—Å—è.

### Graph View üìä
![[Pasted image 20230924120828.png]]

–î–∞–Ω–Ω–∞—è –≤–∫–ª–∞–¥–∫–∞ –æ—á–µ–Ω—å –¥–ª—è –Ω–∞—Å –ø–æ–ª–µ–∑–Ω–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ —Ç—É—Ç –º–æ–∂–Ω–æ —Å–º–æ—Ç—Ä–µ—Ç—å, –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ —É –Ω–∞—Å –≤—ã—Å—Ç—Ä–æ–∏–ª–∏—Å—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏. –ò —É–∂ –ø–æ–≤–µ—Ä—å—Ç–µ, –≤ –±—É–¥—É—â–µ–º —É –Ω–∞—Å –±—É–¥—É—Ç –Ω–∞—Å—Ç–æ–ª—å–∫–æ –º–∞—Å—à—Ç–∞–±–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã, —á—Ç–æ —ç—Ç–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—á–µ–Ω—å –Ω–∞—Å –≤—ã—Ä—É—á–∏—Ç, —Ç–∞–∫ –∫–∞–∫ —É –Ω–∞—Å –ø–æ—è–≤–∏—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–ª–µ–¥–∏—Ç—å –∑–∞ –≤—Å–µ–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏.

### Tree View üå≥

–î–∞–≤–∞–π—Ç–µ –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –∑–∞–ø—É—Å—Ç–∏–º –µ–≥–æ, –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º, —á—Ç–æ –ø–æ–∫–∞–∂–µ—Ç –Ω–∞–º –≤–∫–ª–∞–¥–∫–∞ Tree View.
![[Pasted image 20230924122052.png]]

>[!abstract] –ß—Ç–æ –∑–∞ –∫—Ä—É–∂–æ—á–∫–∏
>–ö–∞–∫ –º–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —è –∑–∞–ø—É—Å–∫–∞–ª —ç—Ç–æ—Ç DAG –Ω–µ 1, –∞ —Ç—Ä–∏ —Ä–∞–∑–∞. –í –ø–µ—Ä–≤—ã–µ 2 —Ä–∞–∑–∞ —É –º–µ–Ω—è –≤—ã–ª–µ–∑–ª–∞ –æ—à–∏–±–∫–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ —è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ—Å—Ç–∞–≤–∏–ª —É–∫–∞–∑–∞–Ω–∏–µ tmp –ø–∞–ø–∫–∏ (–æ–Ω–∞ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –µ—Å—Ç—å –≤ Linux, –∞ —è —Ä–µ—à–∏–ª –∑–∞–ø–∏—Å–∞—Ç—å —Ñ–∞–π–ª—ã –≤ –¥—Ä—É–≥—É—é tmp, –∫–æ—Ç–æ—Ä—É—é –Ω–µ —Å–æ–∑–¥–∞–ª –µ—â–µ –∫ —Ç–æ–º—É –∂–µ). –ù–æ, –∫–∞–∫ –≤—ã –º–æ–∂–µ—Ç–µ —É–≤–∏–¥–µ—Ç—å, –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑ –∑–∞–¥–∞—á–∞ –±—ã–ª–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ! –ò —Ç–µ–ø–µ—Ä—å, –º—ã –º–æ–∂–µ–º –ø–æ–π—Ç–∏ –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å, —á—Ç–æ –∑–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –±–ª–∏–∂–∞–π—à–∏—Ö –∫ –∑–∞–ø—É—Å–∫—É —Ä–∞–∫–µ—Ç –Ω–∞—à —Å–∫—Ä–∏–ø—Ç –≤—ã—Ü–µ–ø–∏–ª.

–¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –õ–æ–≥–∏ –∑–∞–¥–∞—á–∏ get_pictures, –≤–Ω—É—Ç—Ä–∏ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å, —á—Ç–æ –≤—Å–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –±—ã–ª–∏ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:
![[Pasted image 20230924122514.png]]

–ù—É, –∏ –º–æ–º–µ–Ω—Ç –∏—Å—Ç–∏–Ω—ã, —Å–∞–º–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ /tmp/images/.
–ß—Ç–æ–±—ã –∏—Ö –≤—ã—Ç–∞—â–∏—Ç—å –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –æ–±—Ä–∞—Ç–Ω–æ–π –∫–∞–∫ –≤ –Ω–∞—á–∞–ª–µ –∫–æ–º–∞–Ω–¥–æ–π –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤—Å–µ–π –ø–∞–ø–∫–∏:

```cmd
docker cp 0baa77bd960ddf01fd094d1e4de0dea52b76ab96e57a6cebb82a0e7180191581:/tmp/images D:\Mindspace\Apache\proj1_practice\
```

–ü–æ–ª—É—á–∏–ª–æ—Å—å!
–í–æ—Ç –Ω–∞—à–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —É –Ω–∞—Å, –Ω–∞ –Ω–∞—à–µ–º –∫–æ–º–ø–µ:

![[Pasted image 20230924123012.png]]

–ö–æ–Ω–µ—á–Ω–æ, –º–æ–∂–Ω–æ –±—ã–ª–æ –¥–æ–±–∞–≤–∏—Ç—å –µ—â–µ –ø–∞—Ä—É –∑–∞–¥–∞—á –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –≤—ã–≥—Ä—É–∑–∫—É –∫ –Ω–∞–º –Ω–∞ –ü–ö, –Ω–æ –¥–∞ –ª–∞–¥–Ω–æ —É–∂, –∏ —Ç–∞–∫ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ))

---
## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ ü•≥
–°–µ–≥–æ–¥–Ω—è –º—ã —Ä–∞–∑–æ–±—Ä–∞–ª–∏ –æ—á–µ–Ω—å –≤–∞–∂–Ω—É—é –∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—É—é —Ç–µ–º—É, –Ω–∞—É—á–∏–ª–∏—Å—å —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ DAG —Ñ–∞–π–ª—ã. –í —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–Ω—è—Ç–∏–∏ –º—ã –∏–∑—É—á–∏–º **–∑–∞–ø—É—Å–∫ DAG —á–µ—Ä–µ–∑ —Ä–∞–≤–Ω—ã–µ –ø—Ä–æ–º–µ–∂—É—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–∏**, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∞—Ç—å —Ç–∞–∫–∏–µ –≤–æ—Ç –∫–∞—Ä—Ç–∏–Ω–∫–∏, –Ω—É, –¥–æ–ø—É—Å—Ç–∏–º –∫–∞–∂–¥—ã–π –¥–µ–Ω—å. –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –±—É–¥–µ—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ **–û–ø–µ—Ä–∞—Ç–æ—Ä—ã**.
–°–ø–∞—Å–∏–±–æ –∑–∞ –ø—Ä–æ—á—Ç–µ–Ω–∏–µ, –µ—Å–ª–∏ –≤—ã —ç—Ç–æ —Å–¥–µ–ª–∞–ª–∏, —Ç–æ –≤—ã **–û–≥—Ä–æ–º–Ω–µ–π—à–∏–π –º–æ–ª–æ–¥–µ—Ü**)


